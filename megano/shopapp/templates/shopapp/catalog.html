{% extends "shopapp/base_main.html" %}
{% load i18n %}
{% load static %}
{% block middle %}
    <div class="Middle Middle_top">
        <div class="Middle-top">
            <div class="wrap">
                <div class="Middle-header">
                    <h1>{{ category }}</h1>
                    <form id="filter-form">
                        <div class="filter-group">
                            <label for="price-from">{% translate 'Price from' %}:</label>
                            <input type="number" id="price-from" name="price-from">
                        </div>
                        <div class="filter-group">
                            <label for="price-to">{% translate 'Price to' %}:</label>
                            <input type="number" id="price-to" name="price-to">
                        </div>
                        <div class="filter-group">
                            <label for="name-filter">{% translate 'Search on name' %}:</label>
                            <input type="text" id="name-filter" name="name-filter">
                        </div>
                        <div class="filter-group">
                            <label for="description-filter">{% translate 'Search on description' %}:</label>
                            <input type="text" id="description-filter" name="description-filter">
                        </div>
                        <div class="filter-group">
                            <label for="seller-filter">{% translate 'Filter by seller' %}:</label>
                            <select id="seller-filter" name="seller-filter" multiple>
                                <option value="seller1">{% translate 'Seller 1' %}</option>
                                <option value="seller2">{% translate 'Seller 2' %}</option>
                                <option value="seller3">{% translate 'Seller 3' %}</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="boolean-filter">{% translate 'Filter by boolean characteristics' %}:</label>
                            <select id="boolean-filter" name="boolean-filter">
                                <option value="yes">{% translate 'Yes' %}</option>
                                <option value="no">{% translate 'No' %}</option>
                                <option value="">{% translate 'Ignore' %}</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="list-filter">{% translate 'Filter by characteristic-list' %}:</label>
                            <input type="checkbox" id="list-option1" name="list-filter" value="option1">
                            <label for="list-option1">{% translate 'Option 1' %}</label>
                            <input type="checkbox" id="list-option2" name="list-filter" value="option2">
                            <label for="list-option2">{% translate 'Option 2' %}</label>
                            <input type="checkbox" id="list-option3" name="list-filter" value="option3">
                            <label for="list-option3">{% translate 'Option 3' %}</label>
                        </div>
                        <button type="submit">{% translate 'Apply filters' %}</button>
                    </form>

                    <ul class="product-list">
                        {% for product in products %}
                            <li class="product-item">
                                <img class="product-image" src="{{ product.image.url }}" alt="{{ product.name }}">
                                <div class="product-details">
                                    <h3 class="product-title">{{ product.name }}</h3>
                                    <p class="product-price">{{ product.price }}</p>
                                    <p class="product-description">{{ product.description }}</p>
                                </div>
                            </li>
                        {% empty %}
                            <li>{% translate 'No products' %}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
<script>
    $(document).ready(function() {
    $('#filter-form').submit(function(event) {
        event.preventDefault();

        var priceFrom = $('#price-from').val();
        var priceTo = $('#price-to').val();
        var nameFilter = $('#name-filter').val();
        var descriptionFilter = $('#description-filter').val();
        var selectedSellers = $('#seller-filter').val();
        var booleanFilter = $('#boolean-filter').val();
        var selectedOptions = $('input[name="list-filter"]:checked').map(function() {
            return this.value;
        }).get();

        $.ajax({
            url: '/filter-products',
            method: 'GET',
            data: {
                priceFrom: priceFrom,
                priceTo: priceTo,
                nameFilter: nameFilter,
                descriptionFilter: descriptionFilter,
                selectedSellers: selectedSellers,
                selectedManufacturers: selectedManufacturers,
                booleanFilter: booleanFilter,
                selectedOptions: selectedOptions
            },
            success: function(response) {
                $('.product-list').html(response);
            }
        });
    });
});
</script>
{% endblock %}
